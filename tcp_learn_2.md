#图解TCP/IP分层与数据在网络中的传送 (2)

## 子网内从A发到B数据发送过程是如何封装和解封装的

学习了基础知识，我们来看看一个机器A发送数据到B数据是如何过去的，先来个简单点的，A和B在同一个子网内通过一个交换机相连，A的IP地址是10.0.0.2，MAC地址是MA，B的IP地址是10.0.0.8，MAC地址是MB

![Alt text](https://github.com/carrier001/blog/blob/master/data.png "") 

1.  A计算机首先判断B计算机的IP地址和自己的IP地址是否在一个网段，即网络部分是否相同，本例在一个网段内即同一子网。
2.  计算机A执行封装过程，源IP 10.0.0.2，目的IP 10.0.0.8，源MAC MA，目的MAC MB，发出的数据帧见上图的1（假设A机器已经知道B机器的MAC，如果不知道则通过ARP可获得）。
3.  数据帧到达交换机，交换机通过地址学习保存有各个端口对应的MAC地址，当数据帧到达交换机后，交换机解析数据链路层的头，根据目的MAC地址从对应的端口转发出去。（下图是专家何克荣在《交换机的基本原理和配置》中的截图供参考理解）

![Alt text](https://github.com/carrier001/blog/blob/master/route.png "封包") 

4. 数据帧从交换机转发出来后的数据帧见上图的2，可以看出与1完全一样，就是说交换机仅仅转发了，没有对数据帧进行改动。
5.  一个比较弱智的思考题：交换机为什么没有和路由器一样，在转发端口配置IP地址？甚至MAC地址都不需要配置啊？

看了上面的数据发送过程，再看看下图的数据包在A、交换机、B的封装和解封，注意看在一个子网内对应层面的报文是完全相同的，是不是很简单啊

![Alt text](https://github.com/carrier001/blog/blob/master/same.png "") 

预告，后面图解A和B不在一个子网的情形
